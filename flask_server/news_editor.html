<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technopia ë‰´ìŠ¤ í¸ì§‘ê¸°</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background: #f4f7f9; color: #333; padding: 2rem; }
        .container { max-width: 1200px; margin: auto; }
        .header { text-align: center; margin-bottom: 2rem; }
        .header h1 { color: #2c5aa0; }
        .instructions { background: #e3f2fd; color: #1e88e5; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; border-left: 5px solid #1e88e5; }
        .editor-container { display: flex; gap: 2rem; }
        .editor-panel { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); flex: 1; }
        .preview-panel { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); flex: 1.2; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: bold; }
        .form-group input, .form-group textarea { width: 100%; padding: 0.8rem; border: 1px solid #ccc; border-radius: 4px; }
        .btn { background: #2c5aa0; color: white; border: none; padding: 0.8rem 1.2rem; border-radius: 4px; cursor: pointer; margin-right: 0.5rem; }
        .btn:hover { background: #1e3d6f; }
        .btn-danger { background: #e53935; }
        .btn-danger:hover { background: #c62828; }
        .json-output { background: #222; color: #0f0; padding: 1rem; border-radius: 4px; margin-top: 1rem; max-height: 200px; overflow-y: auto; white-space: pre-wrap; }
        .preview-image { max-width: 100%; height: auto; border-radius: 8px; margin-top: 1rem; }
        .news-list-item { padding: 1rem; border: 1px solid #eee; border-radius: 4px; margin-bottom: 0.5rem; cursor: pointer; }
        .news-list-item:hover { background: #f0f0f0; }
        .news-list-item.selected { background: #e3f2fd; border-left: 5px solid #1e88e5; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ Technopia ë‰´ìŠ¤ í¸ì§‘ê¸°</h1>
        </div>

        <div class="instructions">
            <h3>ì‚¬ìš© ë°©ë²•</h3>
            <p>1. ì™¼ìª½ ëª©ë¡ì—ì„œ í¸ì§‘í•  ë‰´ìŠ¤ë¥¼ í´ë¦­í•˜ê±°ë‚˜, 'ìƒˆ ë‰´ìŠ¤ ì‘ì„±' ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>
            <p>2. ì˜¤ë¥¸ìª½ í¼ì—ì„œ ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  'ì €ì¥' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
            <p>3. ì´ë¯¸ì§€ íŒŒì¼ëª…ì€ `static/news_images/` í´ë”ì— ìˆëŠ” íŒŒì¼ëª…ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì˜ˆ: `2025jscrs.jpg`)</p>
            <p>4. ìˆ˜ì •ì´ ì™„ë£Œë˜ë©´ 'JSON ì¶œë ¥' ë²„íŠ¼ì„ ëˆŒëŸ¬ ìƒì„±ëœ ì½”ë“œë¥¼ ë³µì‚¬í•˜ê³ , `flask_server/news_data.json` íŒŒì¼ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
        </div>

        <div class="editor-container">
            <div class="editor-panel">
                <h2>ë‰´ìŠ¤ ëª©ë¡</h2>
                <button class="btn" onclick="createNewNews()">ìƒˆ ë‰´ìŠ¤ ì‘ì„±</button>
                <div id="newsList" style="margin-top: 1rem; max-height: 400px; overflow-y: auto;"></div>
            </div>

            <div class="preview-panel">
                <h2 id="form-title">ë‰´ìŠ¤ í¸ì§‘</h2>
                <form id="newsForm">
                    <input type="hidden" id="newsId">
                    <div class="form-group">
                        <label for="title">ì œëª©</label>
                        <input type="text" id="title" required>
                    </div>
                    <div class="form-group">
                        <label for="date">ë‚ ì§œ</label>
                        <input type="date" id="date">
                    </div>
                    <div class="form-group">
                        <label for="link">ë§í¬</label>
                        <input type="url" id="link">
                    </div>
                    <div class="form-group">
                        <label for="image">ì´ë¯¸ì§€ íŒŒì¼ëª…</label>
                        <input type="text" id="image" oninput="updateImagePreview()">
                    </div>
                    <div class="form-group">
                        <label for="body">ë³¸ë¬¸ (HTML ê°€ëŠ¥)</label>
                        <textarea id="body" rows="5"></textarea>
                    </div>
                    <button type="submit" class="btn">ì €ì¥</button>
                    <button type="button" class="btn btn-danger" onclick="deleteNews()" id="deleteBtn" style="display: none;">ì‚­ì œ</button>
                </form>

                <h3>ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°</h3>
                <img id="imagePreview" class="preview-image" src="" alt="ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°" style="display: none;">
            </div>
        </div>
        
        <div style="margin-top: 2rem; background:white; padding: 2rem; border-radius: 8px;">
            <h2>JSON ì¶œë ¥</h2>
            <button class="btn" onclick="generateJSON()">JSON ì¶œë ¥</button>
            <div id="jsonPanel" class="json-output" style="display: none;"></div>
        </div>
    </div>

    <script>
        let newsData = [];
        let selectedNewsId = null;

        const newsForm = document.getElementById('newsForm');
        const newsListEl = document.getElementById('newsList');

        async function loadInitialData() {
            try {
                // news_data.json íŒŒì¼ì´ ê°™ì€ ë””ë ‰í† ë¦¬ì— ìˆë‹¤ê³  ê°€ì •
                const response = await fetch('news_data.json');
                if (response.ok) {
                    newsData = await response.json();
                } else {
                    // íŒŒì¼ì´ ì—†ì„ ê²½ìš°, ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©
                    newsData = [
                        { "id": 4, "title": "ç¬¬40å›JSCRSå­¦è¡“ç·ä¼š ãƒ©ãƒ³ãƒãƒ§ãƒ³ã‚»ãƒŸãƒŠãƒ¼é–‹å‚¬ã®ãŠçŸ¥ã‚‰ã›", "date": "2025-05-26", "link": "https://technopia.co.jp/info/news/4", "image": "2025jscrs.jpg", "body": "ã“ã®åº¦ã€ç¬¬40å›æ—¥æœ¬ç™½å†…éšœå±ˆæŠ˜çŸ¯æ­£æ‰‹è¡“å­¦ä¼šå­¦è¡“ç·ä¼šã«ãŠãã¾ã—ã¦ã€å¼Šç¤¾ä¸»å‚¬ã®ãƒ©ãƒ³ãƒãƒ§ãƒ³ã‚»ãƒŸãƒŠãƒ¼ã‚’é–‹å‚¬ã•ã›ã¦ã„ãŸã ãã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚", "crawled_at": "2025-07-18T13:00:00" },
                        { "id": 3, "title": "å¤æœŸä¼‘æ¥­ã®ãŠçŸ¥ã‚‰ã›", "date": "2025-07-11", "link": "https://technopia.co.jp/info/news/", "image": null, "body": "", "crawled_at": "2025-07-18T12:30:00" },
                        { "id": 2, "title": "ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¦ã‚£ãƒ¼ã‚¯æœŸé–“ã®ä¼‘æ¥­ã®ãŠçŸ¥ã‚‰ã›", "date": "2025-04-08", "link": "https://technopia.co.jp/info/news/", "image": null, "body": "", "crawled_at": "2025-07-18T12:30:00" },
                        { "id": 1, "title": "å¹´æœ«å¹´å§‹ä¼‘æ¥­ã®ãŠçŸ¥ã‚‰ã›", "date": "2024-11-11", "link": "https://technopia.co.jp/info/news/", "image": null, "body": "", "crawled_at": "2025-07-18T12:30:00" }
                    ];
                }
            } catch (error) {
                console.error("news_data.json ë¡œë“œ ì‹¤íŒ¨, ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©:", error);
                // ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©
                newsData = [
                    { "id": 4, "title": "ç¬¬40å›JSCRSå­¦è¡“ç·ä¼š ãƒ©ãƒ³ãƒãƒ§ãƒ³ã‚»ãƒŸãƒŠãƒ¼é–‹å‚¬ã®ãŠçŸ¥ã‚‰ã›", "date": "2025-05-26", "link": "https://technopia.co.jp/info/news/4", "image": "2025jscrs.jpg", "body": "ã“ã®åº¦ã€ç¬¬40å›æ—¥æœ¬ç™½å†…éšœå±ˆæŠ˜çŸ¯æ­£æ‰‹è¡“å­¦ä¼šå­¦è¡“ç·ä¼šã«ãŠãã¾ã—ã¦ã€å¼Šç¤¾ä¸»å‚¬ã®ãƒ©ãƒ³ãƒãƒ§ãƒ³ã‚»ãƒŸãƒŠãƒ¼ã‚’é–‹å‚¬ã•ã›ã¦ã„ãŸã ãã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚", "crawled_at": "2025-07-18T13:00:00" },
                    { "id": 3, "title": "å¤æœŸä¼‘æ¥­ã®ãŠçŸ¥ã‚‰ã›", "date": "2025-07-11", "link": "https://technopia.co.jp/info/news/", "image": null, "body": "", "crawled_at": "2025-07-18T12:30:00" }
                ];
            }
            renderNewsList();
            if (newsData.length > 0) {
                selectNews(newsData[0].id);
            }
        }

        function renderNewsList() {
            newsListEl.innerHTML = '';
            const sortedData = [...newsData].sort((a, b) => new Date(b.date) - new Date(a.date));
            sortedData.forEach(news => {
                const item = document.createElement('div');
                item.className = 'news-list-item';
                item.textContent = `${news.date}: ${news.title}`;
                item.onclick = () => selectNews(news.id);
                if (news.id === selectedNewsId) {
                    item.classList.add('selected');
                }
                newsListEl.appendChild(item);
            });
        }

        function selectNews(id) {
            selectedNewsId = id;
            const news = newsData.find(n => n.id === id);
            if (news) {
                document.getElementById('form-title').textContent = 'ë‰´ìŠ¤ í¸ì§‘';
                document.getElementById('newsId').value = news.id;
                document.getElementById('title').value = news.title;
                document.getElementById('date').value = news.date;
                document.getElementById('link').value = news.link || '';
                document.getElementById('image').value = news.image || '';
                document.getElementById('body').value = news.body || '';
                document.getElementById('deleteBtn').style.display = 'inline-block';
                updateImagePreview();
            }
            renderNewsList();
        }
        
        function createNewNews() {
            newsForm.reset();
            document.getElementById('form-title').textContent = 'ìƒˆ ë‰´ìŠ¤ ì‘ì„±';
            document.getElementById('newsId').value = '';
            document.getElementById('deleteBtn').style.display = 'none';
            selectedNewsId = null;
            updateImagePreview();
            renderNewsList();
        }
        
        function updateImagePreview() {
            const imageName = document.getElementById('image').value;
            const preview = document.getElementById('imagePreview');
            if (imageName) {
                // ë¡œì»¬ íŒŒì¼ ê²½ë¡œì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, static í´ë”ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê²½ë¡œë¥¼ êµ¬ì„±
                preview.src = `static/news_images/${imageName}`;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
            }
        }

        newsForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const id = document.getElementById('newsId').value;
            const newItem = {
                id: id ? parseInt(id) : Math.max(...newsData.map(n => n.id), 0) + 1,
                title: document.getElementById('title').value,
                date: document.getElementById('date').value,
                link: document.getElementById('link').value,
                image: document.getElementById('image').value,
                body: document.getElementById('body').value,
                crawled_at: new Date().toISOString()
            };

            if (id) {
                const index = newsData.findIndex(n => n.id === parseInt(id));
                newsData[index] = newItem;
                alert('ë‰´ìŠ¤ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
                newsData.push(newItem);
                alert('ë‰´ìŠ¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                selectNews(newItem.id);
            }
            renderNewsList();
        });

        function deleteNews() {
            const id = parseInt(document.getElementById('newsId').value);
            if (id && confirm('ì •ë§ ì´ ë‰´ìŠ¤ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                newsData = newsData.filter(n => n.id !== id);
                createNewNews();
                renderNewsList();
                alert('ë‰´ìŠ¤ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        function generateJSON() {
            const panel = document.getElementById('jsonPanel');
            panel.textContent = JSON.stringify(newsData, null, 2);
            panel.style.display = 'block';
            alert('JSON ë°ì´í„°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”.');
        }

        window.onload = loadInitialData;
    </script>
</body>
</html> 